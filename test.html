<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="x-dns-prefetch-control" content="off">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="apple-touch-icon" href="/apple-touch-icon.png">
	<link rel="stylesheet" type="text/css" href="css/test.css">
	<!--[if IE]>
		<meta http-equiv="imagetoolbar" content="no">
		<![if lt IE 9]><link type="text/css" rel="stylesheet" href="css/ie6.css"><![endif]>
	<![endif]-->
	<title>Test</title>
</head><body>

<script type="text/javascript" src="min.js">

var focus = El("#focus",{}, document.body)
var box = El("#results",{}, document.body)
var footer = El("#footer",{}, document.body)

//setInterval(function(){
//	focus.innerHTML = window.outerHeight == window.innerHeight ? 'not focused' : 'focus'
//},1000);

function go(i){
	history.pushState(i, document.title, i);
}

El("div","click",box).on("click",function(){
	go( this.innerHTML="click "+ (++this.id) )
});

El("div","click once",box).on("click",function(){
	Event.remove(this, "click", arguments.callee);
	this.innerHTML="click once "+ (++this.id)
});

/*
mousewheel don't work in IE5.5
In firefox Event.stop doesn't work when innerHTML changed
*/
El("div","mousewheel",box).on("mousewheel",function(e, delta){
	var self = this
	setTimeout(function(){
		self.innerHTML="mousewheel "+delta;
	},10);
	Event.stop(e);
});

load("test.js", function(){
	var modules = ["rpc.js","mvc.js","base64.js","sha.js","xml.js","succinct_trie.js","cookie.js", "haml.js", "history.js"]

	load( modules, function(){

			TestCase.read( "boot.js" )
			TestCase.read( modules )
			var i = 0, test, count = 0, time = 0;
			while (test = _tests[i++]) {
				time += test.time;
				count += test.pass;
				El("div", ""+test,box )
			}
			El("div","Total "+count+" tests in "+time+" ms.", box)

		}
	)
});

/*
window.blur & window.focus for ie6+, chrome
window.pagehide & window.pageshow for ipfone 3+
*/

//"pageshow pagehide popstate focus blur offline online DOMFocusIn DOMFocusOut DOMActivate".replace(/\w+/g, function(name){
//	Event.add(window, name, function(){ El("div", "window " + name + (new Date().format(" HH:MM:ss.SS")), box)})
//	Event.add(document, name, function(){ El("div", "document " + name + (new Date().format(" HH:MM:ss.SS")), box)})
//	Event.add(document.body, name, function(){ El("div", "document.body " + name + (new Date().format(" HH:MM:ss.SS")), box)})
//})
//
//El("input:disabled", null, box);


/*
var start = new Date(), arr;

footer.innerHTML="";
arr = [];
start = new Date();
for (var i=0;i<1000;arr[i++]=El("div","tere"));
footer.append(arr);
El("div", "time1 "+(new Date() - start),box);

footer.innerHTML="";
arr = [];
start = new Date();
for (var i=0;i<1000;arr[i++]="<div>tere</div>");
footer.innerHTML = arr.join("");
El("div", "time2 "+(new Date() - start),box);

footer.innerHTML="";
arr = [];
var str="";
start = new Date();
for (var i=0;i++<1000;str+="<div>tere</div>");
footer.innerHTML = str
El("div", "time3 "+(new Date() - start),box);

footer.innerHTML="";
arr = [];
var str="";
start = new Date();
for (var i=0;i++<1000;footer.innerHTML+="<div>tere</div>");
El("div", "time4 "+(new Date() - start),box);
footer.innerHTML="";
*/

</script>


</body></html>
